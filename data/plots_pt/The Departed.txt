Quando era criança, Colin Sullivan (Damon) tinha sido apresentado a uma organização criminosa irlandesa-americana de Frank Costello (Nicholson), no bairro Irlandês de South Boston. Ao longo dos anos, Costello prepara o ainda garoto Sullivan para entrar infiltrado na polícia do estado de Massachusetts, até que Sullivan é aceito na Unidade de Investigações Especiais, que incide sobre o crime organizado. Antes de se formar na academia de polícia, Billy Costigan (DiCaprio) é recrutado pelo capitão Queenan (Sheen) e o sargento Dignam (Wahlberg) para ir disfarçado, devido seus laços familiares com o crime organizado o que faz dele um agente infiltrado perfeito e de confiança. Ele sai da academia e passa um tempo na prisão devido a uma "falsa acusação de assalto", um teste, para aumentar a sua confiança e credibilidade aos olhos de Queenan e Dignam, que precisam dessa prova para aceitar Costigan na Polícia, que possui notas altas a nível de um astronauta de que a um mero polícial.
Cada homem se infiltra em sua na respectiva organização, e Sullivan começa um romance com da psiquiatra da polícia Madolyn Madden (Farmiga). Costigan vai vê-la sob os termos de sua liberdade condicional, e eles também começam um relacionamento. Depois de Costello escapar em uma operação policial, cada infiltrado torna-se consciente da existência um do outro. É dito a Sullivan para encontrar o "rato" e pede Costello para obter informações para identificar o informador. Costigan segue Costello em um teatro pornô, onde Costello dá para Sullivan um envelope contendo informações pessoais sobre os membros de sua tripulação. Costigan persegue Sullivan através de Chinatown. Quando acaba, nem um conhece a identidade um do outro. Sullivan tem Queenan atado a uma reunião com Costigan no telhado de um edifício. Queenan ordena Costigan a fugir enquanto ele confronta os homens de Costello sozinho. Os homens então jogam Queenan fora do edifício para a sua morte. Quando saem, Costigan finge que veio a se juntar a eles. Noticiários de televisão relatam que o tripulante Delahunt (Rolston) tem sido um policial da polícia de Boston sob disfarce, mas Costello acredita que seja uma mentira, provavelmente projetada para acalma-lo em uma sensação de segurança. Dignam renuncia ao invés de trabalhar com Sullivan, que ele suspeita que é a toupeira depois que é perguntado por que ele tinha seguido Queenan.
Usando o telefone do Queenan, Sullivan chega a Costigan, que se recusa a abortar sua missão. Sullivan descobre com o diário sobre o papel de Costello como informante para o FBI de Queenan, fazendo com que ele se preocupe com sua própria identidade sendo revelada. Com a ajuda de Costigan, é atribuída a Costello para vender cocaína, onde um tiroteio irrompe entre a tripulação de Costello e da polícia, o que resulta em maior parte da tripulação sendo morta. Costello, confrontado por Sullivan, admite que ele é um informante do FBI. Costello tenta atirar em Sullivan, mas Sullivan atira várias vezes. Com Costello morto, Sullivan é aplaudido no dia seguinte por todos na força. De boa fé, Costigan trata de Sullivan para a restauração da sua verdadeira identidade e de ser pago por seu trabalho, mas observa que o envelope de Costello na mesa de Sullivan e foge, finalmente percebendo que Sullivan é o inimigo. Temendo retaliação, Sullivan apaga os registros de Costigan do sistema de computador da polícia. Sullivan não sabe que Madolyn teve um caso com Costigan quando ela diz a Sullivan que está grávida. Mais tarde, Sullivan encontra-la ouvindo um CD de Costigan contendo incriminatórias conversas gravadas entre Costello e Sullivan. Sullivan, sem sucesso tenta amenizar suas suspeitas. Ele, então, contata Costigan, que revela que Costello registrou cada uma das suas conversas, que o advogado de Costello deixou Costigan na posse das gravações, e que Costigan pretende implicar Sullivan. Os dois concordam em fazer uma reunião no prédio onde Queenan morreu.
No telhado, Costigan pega Sullivan fora de guarda e as algemas dele. Como Costigan tinha secretamente arranjado, Trooper Brown (Anderson) aparece no telhado também. Chocado, Brown pega sua arma em Costigan, que tenta justificar suas ações, expondo Sullivan em mol de Costello. Costigan pede a Brown para Dignam não acompanhá-lo quando Costigan tinha solicitado, mas Brown não respondee. Costigan leva Sullivan, seu refém, até o elevador. Quando se atinge o piso térreo, Trooper Barrigan (Dale) atira em Costigan na cabeça, em seguida, dispara em Brown, e depois revela a Sullivan que Costello tinha mais do que um infiltrado na polícia. Sullivan, em seguida, atira e mata Barrigan. Na sede da polícia estadual, Sullivan identifica Barrigan como a toupeira e recomenda Costigan para a Medalha de Mérito. No funeral de Costigan, Sullivan observa que Madolyn chora. Ao sair do sepultamento, Sullivan tenta falar com ela, mas ela o ignora. Quando Sullivan retorna ao seu apartamento, ele é emboscado por Dignam, que atira e mata-o quando ele entra.
