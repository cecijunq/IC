O filme se passa em 1931, quando a China estava convulsionada pela Guerra Civil. Ao embarcar no expresso de Xangai, um trem (comboio) que vai partir de Pequim, o capitão britânico Donald 'Doc' Harvey é avisado pelos amigos de que a notória cortesã "Shanghai Lily" será também uma passageira. Eles se referem a ela pejorativamente como "coaster" ou de "alto custo", pois teria arruinado financeiramente com seus caprichos, cinco homens.
Quando Doc a encontra, ele a reconhece como Magdalen, uma antiga amante de quem se separara havia cinco anos em função das suas obrigações militares. Shangai Lily divide uma cabine de primeira classe com outra cortesã, a chinesa Hui Fei. Também viajam na primeira classe o reverendo Sr. Carmichael, o jogador inveterado Sam Salt, o traficante de ópio Eric Baum, a anciã Sra. Haggerty, o oficial francês Major Lenard e o misterioso eurasiano Henry Chang.
Durante a viagem, soldados do governo páram o trem e prendem um agente rebelde que se misturava com os passageiros. Depois que o trem é recolocado em marcha, o Sr. Chang se revela como um comandante rebelde e resolve tomar o comboio com suas tropas. Ele escolhe um dos passageiros para fazê-lo de refém e o trocar pelo espião detido. Doc é o escolhido, obrigando Shangai Lily a se sacrificar para salvá-lo.