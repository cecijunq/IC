In 1972, Ron Stallworth is hired as the first black officer in the Colorado Springs Police Department. Assigned to work in the records room, he tires of being bullied and applies to be an undercover officer. He is assigned to infiltrate a local rally where national civil rights leader Kwame Ture (a.k.a. Stokely Carmichael) is speaking. At the rally, Stallworth meets Patrice Dumas, president of the Black Student Union at Colorado College. While taking Ture to his hotel, Patrice is stopped by patrolman Andy Landers, a racist officer in Stallworth's precinct, who threatens Ture and gropes Patrice.
Following the rally, Stallworth is reassigned to the intelligence division. After reading about a local division of the Ku Klux Klan in the newspaper, he calls posing as a white man. He speaks with Walter Breachway, the president of the Colorado Springs chapter, but soon realizes that not only did he use his real name, but he must also meet the Klan members. Stallworth recruits his Jewish coworker, Flip Zimmerman, to impersonate him and meet the KKK members while he continues posing as white on the phone. Under Stallworth's identity, Zimmerman meets Breachway, the slightly more reckless and unstable Felix Kendrickson (and later his wife Connie), and Ivanhoe, who cryptically refers to an upcoming terrorist attack.
Calling Ku Klux Klan headquarters in Louisiana to expedite his membership, Stallworth begins regular phone conversations with Grand Wizard David Duke. Kendrickson suspects Zimmerman of being Jewish and tries to force him to take a polygraph test at gunpoint, but Stallworth, overhearing everything on the wire Zimmerman is wearing, breaks the Kendricksons' kitchen window as a distraction. Stallworth begins dating Patrice without telling her that he is a police officer. After passing information to the Army CID about active-duty members, he learns from an FBI agent that two members are personnel stationed at NORAD, a critical, high-security defense facility.
Duke visits Colorado Springs for Stallworth's induction into the Klan. Over the real Stallworth's protests, the detective is assigned to a protection detail for Duke. Once Zimmerman, masquerading as Stallworth, is initiated, Connie Kendrickson leaves the ceremony to place an explosive device at a local civil rights rally. The real Stallworth realizes her intentions and alerts local police officers. When Connie notices a heavy police presence at the rally, she puts Felix's backup plan into action and plants the device at Dumas's house, leaving it under her car when it will not fit into the mailbox. Stallworth tackles her as she tries to flee, but uniformed officers detain and beat him despite his protests that he is working undercover.

The bombmaker, Walker, had recognized Zimmerman from a prior arrest and informed Felix at the Klan reception.  He, Felix, and Ivanhoe drive to Dumas's house and park next to her car without realizing that the device is hidden underneath. When they detonate it, the explosion kills all three. Zimmerman arrives, frees Stallworth, and arrests Connie. 
While Stallworth is celebrating the closed case that night with Patrice, Landers arrives and harasses the two, remorselessly admitting to his assault on Patrice. Stallworth reveals he is wearing a wire, and Police Chief Bridges arrives and arrests Landers for police brutality.
Bridges congratulates the team for their success but orders them to end their investigation and destroy the records. Stallworth receives a call from Duke, and he insultingly tells Duke he is black before hanging up. 
Later while Dumas and Stallworth discuss their future, they are interrupted by a knock on the door. Through the window in the hallway, they see a flaming cross on a hillside surrounded by KKK members. 
The film cuts to footage of the 2017 Unite the Right rally, the hit and run attack that killed and injured protesters, part of a speech by David Duke, and comments by President Donald Trump. It ends with a dedication to Heather Heyer (who was killed in the attack) and lastly, shows an upside-down American flag fading to a black-and-white American flag, before fading to black.