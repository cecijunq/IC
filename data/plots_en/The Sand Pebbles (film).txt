In 1926, during China's Warlord Era, Jake Holman transfers to the Yangtze River Patrol gunboat USS San Pablo as their new engineer. The ship is nicknamed the "Sand Pebble," and its sailors are "Sand Pebbles".
The crew hires unofficial Chinese workers to do most of the work. Holman upsets the balance as he takes responsibility for the operation of the ship's engine but becomes friends with Frenchy, a seasoned sailor.
A problem with the engine causes the death of Chien, the chief Chinese engine worker, due to an issue Holman noticed but the captain declined to fix. Lop-eye Shing, leader of the Chinese workers, blames Holman. The captain tells Holman he needs to find a Chinese replacement. Holman trains Po-Han to understand the work they are doing.
While on shore leave, the sailors spend time at a bar and brothel run by a former sailor. They are transfixed by Maily, the new hostess, but discover that she fetches a high price since she is still a virgin. Frenchy discovers that the price is the debt she needs to pay to get her freedom.
Meanwhile, sailor Stawski conspires with Shing to get Po-Han fired. Holman convinces Stawski to participate in a boxing match: if Stawski wins, he gets the money needed for a night with Maily, but if he loses, Po-Han gets his job back. During the fight, Stawski is subdued. As he is being counted, the alarm sounds for all sailors to return. They embark ahead of a mob: the captain had gotten word of a battle between British warships and a Chinese warlord. This has soured Chinese opinion of foreigners. It has also boiled over into the Chinese Civil War between the Communist Party under Mao Zedong and the Kuomintang under Chiang Kai-shek. The San Pablo must remain neutral while rescuing stranded Americans, including missionary Jameson and Shirley Eckert, his schoolteacher assistant. During the rescue, Shing sends Po-Han ashore, where he is tortured by the mob. Holman violates the captain's orders by shooting Po-Han, putting him out of his misery.
As the ship returns to port, they find that local opinion of them has not improved. Jameson and Eckert continue their mission on shore. At the bordello, Frenchy tries to pay for Maily's freedom, but instead she is put up for auction. Holman tries to help Frenchy pay the higher amount, but a fight breaks out and the three of them make a dash for it. Eventually, Frenchy and Maily have an unofficial marriage in an empty church. Holman and Eckert fall in love, but he thinks it cannot last, as he will likely be shipping out of China soon. The crew is stuck for the winter, waiting for the water levels to rise. The Chinese workers abandon ship, and shore leave is cancelled. Frenchy regularly swims to shore to be with Maily, but the cold winter waters eventually cause his death. Chinese forces kill Maily and frame Holman for her murder. They surround the ship and demand his surrender. The crew also demands he surrender, until the captain fires a gun across the bow of a Chinese ship and calls for the San Pablo to attempt to leave.
The same day, they received word of the Nanking Incident. They travel to rescue Jameson and Eckert. The San Pablo must break through a barricade of roped-together junks blocking the river. A team is sent to cut the rope. Fighting breaks out, and twelve U.S. crewmen and many Chinese are killed. Holman chops through the rope while under fire. He kills a Chinese militiaman who attacks him, then recognizes him as a friend of Jameson and Eckert. Once free, the ship continues upriver.
Upon arrival, Jameson and Eckert refuse rescue. Collins orders Holman to remove them, but he declares that he is staying with them. Nationalist soldiers attack, killing Jameson. Collins orders the patrol to take Eckert to the ship and remains behind to provide cover fire. Collins is killed, leaving Holman in command. Before parting, Holman and Eckert declare their love, with Holman promising to follow her. He kills several soldiers but is fatally shot as he is about to rejoin the others. Eckert and the remaining two sailors reach the ship, and the San Pablo sails away.